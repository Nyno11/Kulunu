<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Kulunu — Wallet</title>
<link href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.css" rel="stylesheet" />
<style>
  :root{
    --brand:#0c7cff;
    --brand-dark:#065ac9;
    --bg:#f8faff;
    --card:#fff;
    --muted:#777;
    --radius:14px;
  }
  *{box-sizing:border-box;margin:0;padding:0;font-family:Poppins,system-ui,Arial;}
  body{background:var(--bg);padding-bottom:110px;color:#222;}

  /* header */
  header{
    position:fixed;top:0;left:0;right:0;
    display:flex;align-items:center;justify-content:space-between;
    padding:16px 5%;background:var(--card);z-index:120;
    box-shadow:0 4px 16px rgba(0,0,0,0.06);
  }
  .header-left{display:flex;gap:12px;align-items:center;}
  .profile-icon{font-size:30px;color:var(--brand);background:#e8f2ff;padding:8px;border-radius:50%;}
  .user-info small{display:block;line-height:1.05;}
  .user-name{font-weight:700}
  .user-email{font-size:12px;color:var(--muted);}
  .notif-icon{font-size:24px;color:var(--brand);cursor:pointer}

  /* main container */
  .page { padding: 100px 5% 140px; max-width:960px; margin:0 auto; }

  /* wallet card */
  .wallet-card{
    background:linear-gradient(135deg,var(--brand),var(--brand-dark));
    color:#fff;padding:22px;border-radius:18px;box-shadow:0 10px 30px rgba(12,118,204,0.12);
    display:flex;flex-direction:column;gap:8px;
  }
  .wallet-top{display:flex;justify-content:space-between;align-items:center;gap:12px;}
  .wallet-label{opacity:.95}
  .wallet-balance{font-size:34px;font-weight:800;letter-spacing:0.2px}
  .wallet-id{font-size:12px;opacity:.9}

  /* loading skeleton */
  .skeleton{background:linear-gradient(90deg, rgba(255,255,255,0.08), rgba(255,255,255,0.18), rgba(255,255,255,0.08));height:100%;border-radius:8px}

  /* quick actions */
  .actions{display:flex;gap:14px;margin-top:18px}
  .action-btn{flex:1;background:var(--card);padding:12px;border-radius:12px;text-align:center;box-shadow:0 6px 16px rgba(0,0,0,0.06);cursor:pointer}
  .action-btn i{font-size:22px;color:var(--brand);display:block;margin-bottom:6px}
  .action-btn span{font-weight:600;color:#222;font-size:14px}

  /* transactions section header */
  .section-head{display:flex;justify-content:space-between;align-items:center;margin-top:26px;margin-bottom:12px}
  .section-head h3{font-size:18px}
  .small-link{font-size:13px;color:var(--brand);font-weight:600;cursor:pointer}

  /* transaction list */
  .tx-list{display:flex;flex-direction:column;gap:10px}
  .tx-item{display:flex;justify-content:space-between;align-items:center;background:var(--card);padding:12px;border-radius:12px;box-shadow:0 6px 14px rgba(0,0,0,0.05)}
  .tx-left{display:flex;gap:12px;align-items:center}
  .tx-icon{width:44px;height:44px;border-radius:10px;background:#f4f7fb;display:flex;align-items:center;justify-content:center;font-size:18px;color:var(--brand)}
  .tx-info strong{display:block}
  .tx-meta{font-size:12px;color:var(--muted)}
  .tx-amount{font-weight:700}

  /* dock bottom */
  .dock{position:fixed;left:0;right:0;bottom:0;height:86px;background:#fff;box-shadow:0 -6px 18px rgba(0,0,0,0.06);display:flex;justify-content:space-around;align-items:center;border-radius:18px 18px 0 0;z-index:130}
  .dock-item{display:flex;flex-direction:column;align-items:center;font-size:13px;color:var(--muted)}
  .dock-item i{font-size:22px;margin-bottom:4px}
  .dock-item.active{color:var(--brand)}

  /* modals (overlay) */
  .overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.45);backdrop-filter:blur(4px);align-items:center;justify-content:center;padding:20px;z-index:200}
  .modal{width:100%;max-width:480px;background:#fff;border-radius:16px;padding:18px;box-shadow:0 20px 50px rgba(0,0,0,0.12)}
  .modal h4{margin-bottom:8px}
  .modal .row{display:flex;gap:10px}
  .modal .field{margin:10px 0}
  .close-x{position:absolute;right:16px;top:14px;font-size:20px;color:#666;cursor:pointer}

  /* form controls */
  .input, input, select{width:100%;padding:12px;border-radius:10px;border:1px solid #e6ecf6;font-size:14px;outline:none}
  .btn{background:var(--brand);color:#fff;padding:12px 14px;border-radius:10px;border:none;font-weight:700;cursor:pointer}
  .btn.ghost{background:#fff;color:var(--brand);border:1px solid #e6ecf6}

  /* transaction page full */
  .page-full{position:fixed;inset:0;background:var(--bg);z-index:150;padding:110px 5% 110px;overflow:auto;display:none}
  .page-full .title-row{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px}
  .badge{background:#fff;padding:8px 12px;border-radius:999px;font-weight:700;color:var(--brand);box-shadow:0 6px 14px rgba(12,118,204,0.06)}

  /* cards list (linked cards) */
  .cards-grid{display:flex;gap:12px;flex-wrap:wrap;margin-top:10px}
  .card-item{flex:1 1 210px;background:linear-gradient(90deg,#fff,#fff);padding:14px;border-radius:12px;box-shadow:0 10px 24px rgba(0,0,0,0.06);display:flex;flex-direction:column;gap:8px}
  .card-item small{color:var(--muted)}

  /* small screens */
  @media (max-width:420px){
    .wallet-balance{font-size:28px}
    .modal{padding:14px}
    .dock{height:86px}
  }
</style>
</head>
<body>

<!-- header -->
<header>
  <div class="header-left">
    <i class="ri-user-3-fill profile-icon" aria-hidden="true"></i>
    <div class="user-info">
      <small class="user-name" id="uiName">Nonso Chukwu</small>
      <small class="user-email" id="uiEmail">nonso@kulunu.com</small>
    </div>
  </div>
  <i class="ri-notification-3-line notif-icon" id="openNotifications" title="Notifications"></i>
</header>

<!-- main page -->
<div class="page">

  <!-- wallet card -->
  <div class="wallet-card" role="region" aria-label="Wallet balance">
    <div class="wallet-top">
      <div>
        <div class="wallet-label">Available Balance</div>
        <div class="wallet-balance" id="balance">₦ <span id="balanceValue">0</span></div>
        <div class="wallet-id" id="walletId">Wallet ID: 234-882-557</div>
      </div>
      <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-end">
        <button class="btn" id="openAdd">Add Money</button>
        <button class="btn ghost" id="openWithdraw" style="margin-top:4px">Withdraw</button>
      </div>
    </div>

    <!-- quick actions -->
    <div class="actions" style="margin-top:12px">
      <div class="action-btn" id="gotoTransactions" title="Transactions">
        <i class="ri-file-list-3-line"></i>
        <span>Transactions</span>
      </div>
      <div class="action-btn" id="openLinkCard" title="Link card">
        <i class="ri-credit-card-2-line"></i>
        <span>Link Card</span>
      </div>
      <div class="action-btn" id="openSettings" title="Settings">
        <i class="ri-settings-3-line"></i>
        <span>Settings</span>
      </div>
    </div>
  </div>

  <!-- transactions section header -->
  <div class="section-head">
    <h3>Recent Transactions</h3>
    <div class="small-link" id="viewAllTx">View all</div>
  </div>

  <!-- recent tx list -->
  <div class="tx-list" id="txList">
    <!-- JS will inject items -->
  </div>

  <!-- linked cards & settings preview -->
  <div style="margin-top:18px">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <h3>Linked Cards</h3>
      <div class="small-link" id="manageCards">Manage</div>
    </div>
    <div class="cards-grid" id="cardsGrid">
      <!-- JS inject -->
    </div>
  </div>

</div>

<!-- DOCK -->
<div class="dock" role="navigation" aria-label="Bottom navigation">
  <div class="dock-item"><i class="ri-home-5-line"></i><small>Home</small></div>
  <div class="dock-item"><i class="ri-qr-scan-2-line"></i><small>Scan</small></div>
  <div class="dock-item active"><i class="ri-wallet-3-line"></i><small>Wallet</small></div>
  <div class="dock-item"><i class="ri-menu-3-line"></i><small>Menu</small></div>
</div>

<!-- Modals / overlays -->
<!-- Add Money -->
<div class="overlay" id="overlayAdd">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="addTitle">
    <div style="position:relative">
      <div class="close-x" id="closeAdd">&times;</div>
      <h4 id="addTitle">Add Money</h4>
      <p style="color:var(--muted);font-size:13px;margin-bottom:8px">Top up your Kulunu wallet using card or external payment</p>

      <div class="field">
        <label>Amount (₦)</label>
        <input type="number" id="addAmount" class="input" placeholder="Enter amount" min="100" value="5000">
      </div>

      <div class="field">
        <label>Payment method</label>
        <select id="addMethod" class="input">
          <option value="card">Card (Visa/Mastercard/Verve)</option>
          <option value="googlepay">Google Pay</option>
          <option value="bank">Bank Transfer</option>
        </select>
      </div>

      <div style="display:flex;gap:10px;margin-top:10px">
        <button class="btn" id="confirmAdd">Continue</button>
        <button class="btn ghost" id="cancelAdd">Cancel</button>
      </div>
    </div>
  </div>
</div>

<!-- Withdraw -->
<div class="overlay" id="overlayWithdraw">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="withdrawTitle">
    <div style="position:relative">
      <div class="close-x" id="closeWithdraw">&times;</div>
      <h4 id="withdrawTitle">Withdraw</h4>
      <p style="color:var(--muted);font-size:13px;margin-bottom:8px">Move funds from your Kulunu wallet to your bank.</p>

      <div class="field">
        <label>Amount (₦)</label>
        <input type="number" id="withdrawAmount" class="input" placeholder="Enter amount" min="100" value="2000">
      </div>

      <div class="field">
        <label>Bank account</label>
        <input type="text" id="withdrawAccount" class="input" placeholder="Account number — Bank name">
      </div>

      <div style="display:flex;gap:10px;margin-top:10px">
        <button class="btn" id="confirmWithdraw">Request Withdraw</button>
        <button class="btn ghost" id="cancelWithdraw">Cancel</button>
      </div>
    </div>
  </div>
</div>

<!-- Link Card Modal -->
<div class="overlay" id="overlayCard">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="cardTitle">
    <div style="position:relative">
      <div class="close-x" id="closeCard">&times;</div>
      <h4 id="cardTitle">Link Card</h4>
      <p style="color:var(--muted);font-size:13px;margin-bottom:8px">Securely add your card for fast checkout.</p>

      <div class="field">
        <label>Card type</label>
        <select id="cardType" class="input">
          <option value="visa">Visa</option>
          <option value="mastercard">Mastercard</option>
          <option value="verve">Verve</option>
        </select>
      </div>

      <div class="field">
        <label>Card number</label>
        <input id="cardNumber" class="input" placeholder="4242 4242 4242 4242">
      </div>

      <div class="row" style="margin-top:6px">
        <div style="flex:1">
          <label>Expiry</label>
          <input id="cardExpiry" class="input" placeholder="MM/YY">
        </div>
        <div style="width:110px">
          <label>CVV</label>
          <input id="cardCvv" class="input" placeholder="123">
        </div>
      </div>

      <div style="display:flex;gap:10px;margin-top:12px">
        <button class="btn" id="saveCard">Save Card</button>
        <button class="btn ghost" id="cancelCard">Cancel</button>
      </div>
    </div>
  </div>
</div>

<!-- Settings modal -->
<div class="overlay" id="overlaySettings">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
    <div style="position:relative">
      <div class="close-x" id="closeSettings">&times;</div>
      <h4 id="settingsTitle">Wallet Settings</h4>
      <p style="color:var(--muted);font-size:13px;margin-bottom:8px">Manage notifications and auto-topup rules.</p>

      <div style="margin-top:10px">
        <label style="display:flex;justify-content:space-between;align-items:center">
          <span>Push notifications</span>
          <input type="checkbox" id="toggleNotif">
        </label>
        <div style="height:10px"></div>
        <label style="display:flex;justify-content:space-between;align-items:center">
          <span>Auto top-up when balance &lt; ₦1000</span>
          <input type="checkbox" id="toggleAuto">
        </label>
      </div>

      <div style="display:flex;gap:10px;margin-top:14px">
        <button class="btn" id="saveSettings">Save</button>
        <button class="btn ghost" id="cancelSettings">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Notifications placeholder -->
<div class="overlay" id="overlayNotifs">
  <div class="modal" style="max-width:420px">
    <div class="close-x" id="closeNotifs">&times;</div>
    <h4>Notifications</h4>
    <p style="color:var(--muted);font-size:13px;margin-bottom:8px">Recent alerts</p>
    <div style="display:flex;flex-direction:column;gap:8px">
      <div style="background:#fff;padding:12px;border-radius:10px">Your top-up (₦5,000) was successful — Jul 22</div>
      <div style="background:#fff;padding:12px;border-radius:10px">Ticket refunded — Jul 14</div>
    </div>
  </div>
</div>

<!-- Transactions full page -->
<div class="page-full" id="pageTransactions" aria-hidden="true">
  <div style="display:flex;justify-content:space-between;align-items:center">
    <h2>All Transactions</h2>
    <div class="badge" id="txCount">0</div>
  </div>
  <div style="margin-top:10px">
    <div style="margin-bottom:12px">
      <input type="search" id="txFilter" class="input" placeholder="Search transactions (merchant / amount)"/>
    </div>
    <div id="txAllList" style="display:flex;flex-direction:column;gap:12px"></div>
  </div>
</div>

<script>
/* ---------------------------
   Simple in-memory demo store
   Replace api.* with real endpoints
   --------------------------- */
const store = {
  balance: 52800.00,
  tx: [
    {id:1,type:'debit',title:'Event Ticket',meta:'Lagos Music Fest',date:'2025-07-28',amount:20000},
    {id:2,type:'credit',title:'Top-up',meta:'Card ****4242',date:'2025-07-22',amount:50000},
    {id:3,type:'credit',title:'Cashback',meta:'Flight promo',date:'2025-07-18',amount:2800},
  ],
  cards: [
    {id:1,type:'visa',mask:'**** 4242',expiry:'12/26'}
  ],
  settings: {notif:true,autoTop:false},
  user: {name:'Nonso Chukwu',email:'nonso@kulunu.com'}
};

/* ---------------------------
   API stubs (replace these)
   --------------------------- */
const api = {
  getBalance: async ()=> {
    // replace with fetch('/api/wallet/balance')...
    return {ok:true, data: store.balance};
  },
  getTx: async ()=> ({ok:true, data: store.tx}),
  addMoney: async (amount, method)=> {
    // pretend success: push tx & update balance
    const id = Date.now();
    store.tx.unshift({id,type:'credit',title:'Wallet Top-up',meta:method,date:new Date().toISOString().slice(0,10),amount:Number(amount)});
    store.balance = Number(store.balance) + Number(amount);
    return {ok:true};
  },
  withdraw: async (amount, account)=> {
    const id = Date.now();
    store.tx.unshift({id,type:'debit',title:'Withdraw',meta:account,date:new Date().toISOString().slice(0,10),amount:Number(amount)});
    store.balance = Number(store.balance) - Number(amount);
    return {ok:true};
  },
  saveCard: async (card)=> {
    store.cards.push({...card, id:Date.now()});
    return {ok:true};
  },
  saveSettings: async (s)=> { store.settings = s; return {ok:true};}
};

/* ---------------------------
   UI helpers
   --------------------------- */
const $ = sel => document.querySelector(sel);
const $$ = sel => Array.from(document.querySelectorAll(sel));

function formatN(value){
  return Number(value).toLocaleString(undefined,{maximumFractionDigits:0});
}

/* balance count-up animation */
async function loadBalance(){
  const res = await api.getBalance();
  if(!res.ok) return;
  const target = Number(res.data);
  const el = document.getElementById('balanceValue');
  let start = 0;
  const duration = 800;
  const step = (timestamp)=>{
    const progress = Math.min(1,(Date.now()-t0)/duration);
    const current = Math.floor(start + (target-start)*progress);
    el.textContent = formatN(current);
    if(progress<1) requestAnimationFrame(step);
    else el.textContent = formatN(target);
  };
  const t0 = Date.now();
  requestAnimationFrame(step);
}

/* render recent transactions */
async function renderRecent(){
  const res = await api.getTx();
  if(!res.ok) return;
  const list = res.data.slice(0,5);
  const txList = $('#txList');
  txList.innerHTML = '';
  list.forEach(tx=>{
    const item = document.createElement('div');
    item.className='tx-item';
    item.innerHTML = `
      <div class="tx-left">
        <div class="tx-icon">${ tx.type==='credit' ? '<i class="ri-add-line"></i>' : '<i class="ri-arrow-down-line"></i>' }</div>
        <div class="tx-info">
          <strong>${tx.title}</strong>
          <div class="tx-meta">${tx.meta} • ${tx.date}</div>
        </div>
      </div>
      <div class="tx-amount ${tx.type==='credit'?'credit':'debit'}">${tx.type==='credit'?'+ ':'- '}₦${formatN(tx.amount)}</div>
    `;
    txList.appendChild(item);
  });
}

/* render all transactions page */
async function renderAllTransactions(){
  const res = await api.getTx();
  const target = $('#txAllList');
  const countBadge = $('#txCount');
  target.innerHTML = '';
  if(!res.ok) return;
  const all = res.data;
  countBadge.textContent = all.length;
  all.forEach(tx=>{
    const el = document.createElement('div');
    el.className='tx-item';
    el.innerHTML = `
      <div class="tx-left">
        <div class="tx-icon">${ tx.type==='credit' ? '<i class="ri-add-line"></i>' : '<i class="ri-arrow-down-line"></i>' }</div>
        <div class="tx-info">
          <strong>${tx.title}</strong>
          <small class="tx-meta">${tx.meta} • ${tx.date}</small>
        </div>
      </div>
      <div class="tx-amount ${tx.type==='credit'?'credit':'debit'}">₦${formatN(tx.amount)}</div>
    `;
    target.appendChild(el);
  });
}

/* render cards */
function renderCards(){
  const target = $('#cardsGrid');
  target.innerHTML = '';
  store.cards.forEach(c=>{
    const el = document.createElement('div');
    el.className='card-item';
    el.innerHTML = `<strong>${c.type.toUpperCase()}</strong><small>${c.mask}</small><small>Exp ${c.expiry}</small>`;
    target.appendChild(el);
  });
}

/* ---------------------------
   Modal open/close wiring
   --------------------------- */
function openOverlay(id){ document.getElementById(id).style.display='flex'; }
function closeOverlay(id){ document.getElementById(id).style.display='none'; }

$('#openAdd').addEventListener('click',()=> openOverlay('overlayAdd'));
$('#closeAdd').addEventListener('click',()=> closeOverlay('overlayAdd'));
$('#cancelAdd').addEventListener('click',()=> closeOverlay('overlayAdd'));

$('#openWithdraw').addEventListener('click',()=> openOverlay('overlayWithdraw'));
$('#closeWithdraw').addEventListener('click',()=> closeOverlay('overlayWithdraw'));
$('#cancelWithdraw').addEventListener('click',()=> closeOverlay('overlayWithdraw'));

$('#openLinkCard').addEventListener('click',()=> openOverlay('overlayCard'));
$('#closeCard').addEventListener('click',()=> closeOverlay('overlayCard'));
$('#cancelCard').addEventListener('click',()=> closeOverlay('overlayCard'));

$('#openSettings').addEventListener('click',()=> {
  $('#toggleNotif').checked = store.settings.notif;
  $('#toggleAuto').checked = store.settings.autoTop;
  openOverlay('overlaySettings');
});
$('#closeSettings').addEventListener('click',()=> closeOverlay('overlaySettings'));
$('#cancelSettings').addEventListener('click',()=> closeOverlay('overlaySettings'));

$('#openNotifications').addEventListener('click',()=> openOverlay('overlayNotifs'));
$('#closeNotifs').addEventListener('click',()=> closeOverlay('overlayNotifs'));

$('#gotoTransactions').addEventListener('click', ()=> {
  document.getElementById('pageTransactions').style.display='block';
  renderAllTransactions();
});
$('#viewAllTx').addEventListener('click', ()=> {
  document.getElementById('pageTransactions').style.display='block';
  renderAllTransactions();
});

/* pageTransactions close by clicking outside (or ESC) */
document.getElementById('pageTransactions').addEventListener('click', (e)=>{
  if(e.target === document.getElementById('pageTransactions')) document.getElementById('pageTransactions').style.display='none';
});
document.addEventListener('keydown',(e)=>{ if(e.key==='Escape') {
  ['overlayAdd','overlayWithdraw','overlayCard','overlaySettings','overlayNotifs'].forEach(id=>closeOverlay(id));
  document.getElementById('pageTransactions').style.display='none';
}});

/* confirm add money */
$('#confirmAdd').addEventListener('click', async ()=>{
  const amount = Number($('#addAmount').value);
  const method = $('#addMethod').value;
  if(!amount || amount < 100){ alert('Enter an amount >= ₦100'); return; }
  $('#confirmAdd').textContent='Processing...'; $('#confirmAdd').disabled=true;
  const res = await api.addMoney(amount, method);
  if(res.ok){
    await loadBalance(); renderRecent(); renderCards();
    alert('Top-up successful');
    closeOverlay('overlayAdd');
  } else alert('Top-up failed');
  $('#confirmAdd').textContent='Continue'; $('#confirmAdd').disabled=false;
});

/* confirm withdraw */
$('#confirmWithdraw').addEventListener('click', async ()=>{
  const amount = Number($('#withdrawAmount').value);
  const account = $('#withdrawAccount').value.trim();
  if(!amount || amount<=0 || amount > store.balance){ alert('Invalid amount'); return;}
  if(!account){ alert('Provide bank account details'); return;}
  $('#confirmWithdraw').textContent='Processing...'; $('#confirmWithdraw').disabled=true;
  const res = await api.withdraw(amount, account);
  if(res.ok){ await loadBalance(); renderRecent(); renderAllTransactions(); alert('Withdraw requested'); closeOverlay('overlayWithdraw'); }
  else alert('Failed');
  $('#confirmWithdraw').textContent='Request Withdraw'; $('#confirmWithdraw').disabled=false;
});

/* save card */
$('#saveCard').addEventListener('click', async ()=>{
  const card = {type:$('#cardType').value, mask:'**** '+($('#cardNumber').value.slice(-4)||'0000'), expiry:$('#cardExpiry').value};
  $('#saveCard').textContent='Saving...'; $('#saveCard').disabled=true;
  const res = await api.saveCard(card);
  if(res.ok){ renderCards(); alert('Card linked'); closeOverlay('overlayCard'); }
  else alert('Failed to link');
  $('#saveCard').textContent='Save Card'; $('#saveCard').disabled=false;
});

/* save settings */
$('#saveSettings').addEventListener('click', async ()=>{
  const s = {notif:$('#toggleNotif').checked, autoTop:$('#toggleAuto').checked};
  $('#saveSettings').textContent='Saving...'; $('#saveSettings').disabled=true;
  const res = await api.saveSettings(s);
  if(res.ok){ alert('Settings saved'); closeOverlay('overlaySettings'); }
  else alert('Failed');
  $('#saveSettings').textContent='Save'; $('#saveSettings').disabled=false;
});

/* transactions search filter on full page */
$('#txFilter').addEventListener('input', ()=>{
  const q = $('#txFilter').value.toLowerCase();
  const target = $('#txAllList');
  target.childNodes.forEach(node=>{
    const text = node.textContent.toLowerCase();
    node.style.display = text.includes(q) ? '' : 'none';
  });
});

/* initial render */
(async function init(){
  // populate UI with store data (or fetch user profile)
  $('#uiName').textContent = store.user.name;
  $('#uiEmail').textContent = store.user.email;

  await loadBalance();
  await renderRecent();
  renderCards();

  // click outside modal to close
  $$('.overlay').forEach(o=>{
    o.addEventListener('click', (e)=> { if(e.target === o) o.style.display='none'; });
  });
})();
</script>
</body>
</html>
