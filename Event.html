<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Kulunu Ticketing</title>
  <meta name="description" content="">
  <meta name="keywords" content="">

  <!-- Favicons -->
  <link href="assets/img/ku.png" rel="icon">
  <link href="assets/img/ku.png" rel="apple-touch-icon">

    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.css" rel="stylesheet" />
     <!-- Main CSS File -->
  <link href="assets/css/Event.css" rel="stylesheet"> 
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
</head>
    <!-- MAIN SECTIONS -->
<header>

    <div class="header-right">
        <a href="Ticket.html">
        <i class="bi bi-arrow-left-circle"></i>
        </a>
    </div>
</header>


 <div id="manageEventPage" class="page-section">

  <div class="manage-event">

    <!-- Header -->
    <div class="event-header">
      <h2>Manage Event</h2>
      <button class="primary-btn" onclick="window.location.href='Create-event.html'">Create New Event</button>
    </div>

    <!-- Stats -->
    <div class="event-stats">
      <div class="stat-card">
        <h3>Tickets Sold</h3>
        <p>124</p>
      </div>
      <div class="stat-card">
        <h3>Revenue</h3>
        <p>₦620,000</p>
      </div>
      <div class="stat-card">
        <h3>Attendees</h3>
        <p>118</p>
      </div>
      <div class="stat-card">
        <h3>Event Status</h3>
        <p class="status-live">Live</p>
      </div>
    </div>

    <!-- Event Details -->
    <section class="event-section">
  <h3>Event Details</h3>
  <div class="event-card">
    <p><strong>Title:</strong> <span id="eventTitle">—</span></p>
    <p><strong>Date:</strong> <span id="eventDate">—</span></p>
    <p><strong>Venue:</strong> <span id="eventVenue">—</span></p>
    <p><strong>Type:</strong> <span id="eventType">—</span></p>
  </div>
</section>


<!-- =========================
     TICKETS SECTION
========================= -->
<section class="event-section">
  <div class="section-header">
    <h3>Ticket Types</h3>
    <button class="primary-btn small" onclick="openTicketModal()">Add Ticket</button>
  </div>

  <div id="ticketList" class="ticket-grid"></div>
</section>

<!-- =========================
     TICKET MODAL
========================= -->
<div class="modal" id="ticketModal">
  <div class="modal-content">

    <div class="modal-header">
      <h3>Create Ticket</h3>
      <button onclick="closeTicketModal()">✕</button>
    </div>

    <form id="ticketForm">

      <label>Ticket Name</label>
      <input type="text" id="ticketName" required>

      <label>Ticket Type</label>
      <select id="ticketType">
        <option value="free">Free</option>
        <option value="paid">Paid</option>
      </select>

      <div id="priceField">
        <label>Price (₦)</label>
        <input type="number" id="ticketPrice" min="0">
      </div>

      <label>Quantity Available</label>
      <input type="number" id="ticketQty" min="1" required>

      <button type="submit" class="primary-btn full">
        Save Ticket
      </button>

    </form>

  </div>
</div>
<script>
/* =========================
   LOAD ACTIVE EVENT
========================= */
const activeEvent = JSON.parse(localStorage.getItem("activeEvent"));

if (!activeEvent) {
  alert("No active event found. Please create an event first.");
  window.location.href = "Create-event.html";
}

/* Populate Event Details */
document.getElementById("eventTitle").textContent = activeEvent.title;
document.getElementById("eventDate").textContent = activeEvent.date;
document.getElementById("eventVenue").textContent = activeEvent.venue;
document.getElementById("eventType").textContent =
  activeEvent.type.charAt(0).toUpperCase() + activeEvent.type.slice(1);
</script>

<script>
let eventData = JSON.parse(localStorage.getItem("activeEvent")) || {};
eventData.tickets = eventData.tickets || [];

const ticketModal = document.getElementById("ticketModal");
const ticketList = document.getElementById("ticketList");
const ticketTypeSelect = document.getElementById("ticketType");
const priceField = document.getElementById("priceField");

/* Modal Controls */
function openTicketModal() {
  ticketModal.style.display = "flex";
}

function closeTicketModal() {
  ticketModal.style.display = "none";
  document.getElementById("ticketForm").reset();
}

/* Toggle Price */
ticketTypeSelect.addEventListener("change", () => {
  priceField.style.display =
    ticketTypeSelect.value === "paid" ? "block" : "none";
});

/* Save Ticket */
document.getElementById("ticketForm").addEventListener("submit", e => {
  e.preventDefault();

  const ticket = {
    id: "TKT-" + Date.now(),
    name: ticketName.value,
    type: ticketType.value,
    price: ticketType.value === "paid" ? Number(ticketPrice.value) : 0,
    quantity: Number(ticketQty.value),
    sold: 0
  };

  eventData.tickets.push(ticket);
  localStorage.setItem("activeEvent", JSON.stringify(eventData));

  renderTickets();
  closeTicketModal();
});

/* Render Tickets */
function renderTickets() {
  ticketList.innerHTML = "";

  eventData.tickets.forEach(t => {
    const card = document.createElement("div");
    card.className = "ticket-card";
    card.innerHTML = `
      <h4>${t.name}</h4>
      <span>${t.type === "paid" ? "₦" + t.price : "Free"}</span><br>
      <span>Available: ${t.quantity}</span>
    `;
    ticketList.appendChild(card);
  });
}

renderTickets();
</script>

    <!-- Attendees -->
    <section class="event-section">
      <h3>Attendees</h3>

      <table class="attendee-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Ticket</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>John Doe</td>
            <td>john@email.com</td>
            <td>VIP</td>
            <td class="checked-in">Checked In</td>
          </tr>
          <tr>
            <td>Jane Smith</td>
            <td>jane@email.com</td>
            <td>Regular</td>
            <td class="pending">Pending</td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- QR Scanner -->
    <section class="event-section">
      <h3>QR Code Scanner</h3>
      <div class="qr-box">
        <p>Scan attendee ticket QR code</p>
        <button class="primary-btn">Open Scanner</button>
      </div>
    </section>

  </div>
</div>

</body>
</html>
